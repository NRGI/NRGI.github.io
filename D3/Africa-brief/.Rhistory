setwd("C:\\Users\\tmorrison\\Box\\TRM\\NRGI tmo\\Data requests\\Kaisa, RGI analysis")
library(data.table)
library(ggplot2)
library(data.table); library(ggplot2); library(rvest)
setwd("C:\\Users\\tmorrison\\Documents\\GitHub\\NRGI.github.io\\D3\\Africa-brief")
setwd("C:\\Users\\TRM\\Documents\\GitHub\\NRGI.github.io\\D3\\Africa-brief")
rgi <- as.data.table(read.csv("rgi_data.csv", stringsAsFactors = FALSE))
View(rgi)
rgi <- as.data.table(read.csv("rgi_data.csv", stringsAsFactors = FALSE))
rgi <- rgi[question %in% c("1.4.8) COMMODITY SALE DISCLOSURES",
"1.4.10) SOE CORPORATE GOVERNANCE PRACTICE",
"1.4.7) COMMODITY SALE RULES",
"1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE",
"1.4.9) SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE",
"1.4.6) SOE PRODUCTION DISCLOSURE",
"1.4.5) SOE FINANCIAL REPORTING PRACTICE",
"1.4.4) SOE NON-COMMERCIAL ACTIVITY PRACTICE",
"1.4.3) SOE FINANCIAL REPORTING RULES",
"1.4.1) SOE-GOVERNMENT TRANSFERS RULES")]
oil <- c("Democratic Republic of Congo (mining)","Eritrea","Ethiopia","Ghana (mining)","Guinea","Liberia","Madagascar","Mali","Mauritania","Morocco",
"Niger","Sierra Leone","South Africa","Tanzania (mining)","Tunisia (mining)","Zambia","Zimbabwe")
mining <- c("Algeria","Angola","Cameroon","Chad","Congo","Côte d'Ivoire","Democratic Republic of Congo (oil and gas)","Egypt","Equatorial Guinea","Gabon",
"Ghana (oil and gas)",  "Libya","Mozambique","Nigeria","South Sudan","Sudan","Tanzania (oil and gas)","Tunisia (oil and gas)","Uganda")
rgi <- as.data.table(fread("rgi_data.csv", stringsAsFactors = FALSE))
head(rgi)
View(rgi)
rgi <- rgi[question %in% c("1.4.8) COMMODITY SALE DISCLOSURES",
"1.4.10) SOE CORPORATE GOVERNANCE PRACTICE",
"1.4.7) COMMODITY SALE RULES",
"1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE",
"1.4.9) SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE",
"1.4.6) SOE PRODUCTION DISCLOSURE",
"1.4.5) SOE FINANCIAL REPORTING PRACTICE",
"1.4.4) SOE NON-COMMERCIAL ACTIVITY PRACTICE",
"1.4.3) SOE FINANCIAL REPORTING RULES",
"1.4.1) SOE-GOVERNMENT TRANSFERS RULES")]
rgi <- rgi[, -c("min","max","range","avg","sd","type_question")]
rgi <- melt(rgi, id.vars="question", variable.name = "country")
rgi <- rgi[value==".", value:=NA]
rgi[, value:=as.numeric(value)]
rgi[, country:=as.character(country)]
rgi[question=="1.4.8) COMMODITY SALE DISCLOSURES", question:="COMMODITY SALE DISCLOSURES"]
rgi[question=="1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE", question:="SOE-GOVERNMENT TRANSFERS DISCLOSURE"]
rgi[question=="1.4.10) SOE CORPORATE GOVERNANCE PRACTICE", question:="SOE CORPORATE GOVERNANCE PRACTICE"]
rgi[question=="1.4.7) COMMODITY SALE RULES", question:="COMMODITY SALE RULES"]
rgi[question=="1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE", question:="SOE-GOVERNMENT TRANSFERS DISCLOSURE"]
rgi[question=="1.4.9) SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE", question:="SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE"]
rgi[question=="1.4.6) SOE PRODUCTION DISCLOSURE", question:="SOE PRODUCTION DISCLOSURE"]
rgi[question=="1.4.5) SOE FINANCIAL REPORTING PRACTICE", question:="SOE FINANCIAL REPORTING PRACTICE"]
rgi[question=="1.4.4) SOE NON-COMMERCIAL ACTIVITY PRACTICE", question:="SOE NON-COMMERCIAL ACTIVITY PRACTICE"]
rgi[question=="1.4.3) SOE FINANCIAL REPORTING RULES", question:="SOE FINANCIAL REPORTING RULES"]
rgi[question=="1.4.2b) SOE-government transfer disclosure", question:="SOE-government transfer disclosure"]
rgi <- as.data.table(fread("rgi_data.csv", stringsAsFactors = FALSE))
# rgi <- rgi[grep("SOE", question)]
#Sample questions
rgi <- rgi[question %in% c("1.4.8) COMMODITY SALE DISCLOSURES",
"1.4.10) SOE CORPORATE GOVERNANCE PRACTICE",
"1.4.7) COMMODITY SALE RULES",
"1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE",
"1.4.9) SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE",
"1.4.6) SOE PRODUCTION DISCLOSURE",
"1.4.5) SOE FINANCIAL REPORTING PRACTICE",
"1.4.4) SOE NON-COMMERCIAL ACTIVITY PRACTICE",
"1.4.3) SOE FINANCIAL REPORTING RULES",
"1.4.1) SOE-GOVERNMENT TRANSFERS RULES")]
rgi <- rgi[, -c("min","max","range","avg","sd","type_question")]
rgi <- melt(rgi, id.vars="question", variable.name = "country")
rgi <- rgi[value==".", value:=NA]
rgi[, value:=as.numeric(value)]
rgi[, country:=as.character(country)]
rgi[question=="1.4.8) COMMODITY SALE DISCLOSURES", question:="COMMODITY SALE DISCLOSURES"]
rgi[question=="1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE", question:="SOE-GOVERNMENT TRANSFERS DISCLOSURE"]
rgi[question=="1.4.10) SOE CORPORATE GOVERNANCE PRACTICE", question:="SOE CORPORATE GOVERNANCE PRACTICE"]
rgi[question=="1.4.7) COMMODITY SALE RULES", question:="COMMODITY SALE RULES"]
rgi[question=="1.4.1) SOE-GOVERNMENT TRANSFERS RULES", question:="SOE-GOVERNMENT TRANSFERS RULES"]
rgi[question=="1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE", question:="SOE-GOVERNMENT TRANSFERS DISCLOSURE"]
rgi[question=="1.4.9) SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE", question:="SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE"]
rgi[question=="1.4.6) SOE PRODUCTION DISCLOSURE", question:="SOE PRODUCTION DISCLOSURE"]
rgi[question=="1.4.5) SOE FINANCIAL REPORTING PRACTICE", question:="SOE FINANCIAL REPORTING PRACTICE"]
rgi[question=="1.4.4) SOE NON-COMMERCIAL ACTIVITY PRACTICE", question:="SOE NON-COMMERCIAL ACTIVITY PRACTICE"]
rgi[question=="1.4.3) SOE FINANCIAL REPORTING RULES", question:="SOE FINANCIAL REPORTING RULES"]
rgi[, iso3:=addISO(country)]
addISO <- function(ctr, type="ISO3") {
gs_auth()
iso <- gs_read(gs_key("1vzbrKpKJxtZvChn9FuS1JgPLJGeoRi24tXjgsrf5O9U"), ws="ISO")
setDT(iso)
new <- c()
for(i in 1:length(ctr)){
if(ctr[i] %in% iso$country) {
new[i] <- iso[country==ctr[i]]$iso3
}
if(!ctr[i] %in% iso$country) {
new[i] <- "No match"
print(paste0("Look at: ", i, " - '", ctr[i],"'"))
}
}
new
}
rgi <- as.data.table(fread("rgi_data.csv", stringsAsFactors = FALSE))
# rgi <- rgi[grep("SOE", question)]
#Sample questions
rgi <- rgi[question %in% c("1.4.8) COMMODITY SALE DISCLOSURES",
"1.4.10) SOE CORPORATE GOVERNANCE PRACTICE",
"1.4.7) COMMODITY SALE RULES",
"1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE",
"1.4.9) SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE",
"1.4.6) SOE PRODUCTION DISCLOSURE",
"1.4.5) SOE FINANCIAL REPORTING PRACTICE",
"1.4.4) SOE NON-COMMERCIAL ACTIVITY PRACTICE",
"1.4.3) SOE FINANCIAL REPORTING RULES",
"1.4.1) SOE-GOVERNMENT TRANSFERS RULES")]
rgi <- rgi[, -c("min","max","range","avg","sd","type_question")]
rgi <- melt(rgi, id.vars="question", variable.name = "country")
rgi <- rgi[value==".", value:=NA]
rgi[, value:=as.numeric(value)]
rgi[, country:=as.character(country)]
rgi[question=="1.4.8) COMMODITY SALE DISCLOSURES", question:="COMMODITY SALE DISCLOSURES"]
rgi[question=="1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE", question:="SOE-GOVERNMENT TRANSFERS DISCLOSURE"]
rgi[question=="1.4.10) SOE CORPORATE GOVERNANCE PRACTICE", question:="SOE CORPORATE GOVERNANCE PRACTICE"]
rgi[question=="1.4.7) COMMODITY SALE RULES", question:="COMMODITY SALE RULES"]
rgi[question=="1.4.1) SOE-GOVERNMENT TRANSFERS RULES", question:="SOE-GOVERNMENT TRANSFERS RULES"]
rgi[question=="1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE", question:="SOE-GOVERNMENT TRANSFERS DISCLOSURE"]
rgi[question=="1.4.9) SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE", question:="SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE"]
rgi[question=="1.4.6) SOE PRODUCTION DISCLOSURE", question:="SOE PRODUCTION DISCLOSURE"]
rgi[question=="1.4.5) SOE FINANCIAL REPORTING PRACTICE", question:="SOE FINANCIAL REPORTING PRACTICE"]
rgi[question=="1.4.4) SOE NON-COMMERCIAL ACTIVITY PRACTICE", question:="SOE NON-COMMERCIAL ACTIVITY PRACTICE"]
rgi[question=="1.4.3) SOE FINANCIAL REPORTING RULES", question:="SOE FINANCIAL REPORTING RULES"]
rgi
rgi[country %in% mining]
rgi[country %in% mining, unique(country)]
mining
mining <- c("Democratic Republic of Congo (mining)","Eritrea","Ethiopia","Ghana (mining)","Guinea","Liberia","Madagascar","Mali","Mauritania","Morocco",
"Niger","Sierra Leone","South Africa","Tanzania (mining)","Tunisia (mining)","Zambia","Zimbabwe")
oil <- c("Algeria","Angola","Cameroon","Chad","Congo","Côte d'Ivoire","Democratic Republic of Congo (oil and gas)","Egypt","Equatorial Guinea","Gabon",
"Ghana (oil and gas)",  "Libya","Mozambique","Nigeria","South Sudan","Sudan","Tanzania (oil and gas)","Tunisia (oil and gas)","Uganda")
rgi[country %in% mining, unique(country)]
mining
View(rgi)
rgi <- as.data.table(fread("rgi_data.csv", stringsAsFactors = FALSE))
rgi <- rgi[question %in% c("1.4.8) COMMODITY SALE DISCLOSURES",
"1.4.10) SOE CORPORATE GOVERNANCE PRACTICE",
"1.4.7) COMMODITY SALE RULES",
"1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE",
"1.4.9) SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE",
"1.4.6) SOE PRODUCTION DISCLOSURE",
"1.4.5) SOE FINANCIAL REPORTING PRACTICE",
"1.4.4) SOE NON-COMMERCIAL ACTIVITY PRACTICE",
"1.4.3) SOE FINANCIAL REPORTING RULES",
"1.4.1) SOE-GOVERNMENT TRANSFERS RULES")]
rgi <- rgi[, -c("min","max","range","avg","sd","type_question")]
rgi <- melt(rgi, id.vars="question", variable.name = "country")
View(rgi)
mining <- c("DRC (mining)","Eritrea","Ethiopia","Ghana (mining)","Guinea","Liberia","Madagascar","Mali","Mauritania","Morocco",
"Niger","Sierra Leone","South Africa","Tanzania (mining)","Tunisia (mining)","Zambia","Zimbabwe")
oil <- c("Algeria","Angola","Cameroon","Chad","Congo","Côte d'Ivoire","DRC (oil and gas)","Egypt","Equatorial Guinea","Gabon",
"Ghana (oil and gas)",  "Libya","Mozambique","Nigeria","South Sudan","Sudan","Tanzania (oil and gas)","Tunisia (oil and gas)","Uganda")
rgi <- as.data.table(fread("rgi_data.csv", stringsAsFactors = FALSE))
# rgi <- rgi[grep("SOE", question)]
#Sample questions
rgi <- rgi[question %in% c("1.4.8) COMMODITY SALE DISCLOSURES",
"1.4.10) SOE CORPORATE GOVERNANCE PRACTICE",
"1.4.7) COMMODITY SALE RULES",
"1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE",
"1.4.9) SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE",
"1.4.6) SOE PRODUCTION DISCLOSURE",
"1.4.5) SOE FINANCIAL REPORTING PRACTICE",
"1.4.4) SOE NON-COMMERCIAL ACTIVITY PRACTICE",
"1.4.3) SOE FINANCIAL REPORTING RULES",
"1.4.1) SOE-GOVERNMENT TRANSFERS RULES")]
rgi <- rgi[, -c("min","max","range","avg","sd","type_question")]
rgi <- melt(rgi, id.vars="question", variable.name = "country")
rgi <- rgi[value==".", value:=NA]
rgi[, value:=as.numeric(value)]
rgi[, country:=as.character(country)]
rgi[question=="1.4.8) COMMODITY SALE DISCLOSURES", question:="COMMODITY SALE DISCLOSURES"]
rgi[question=="1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE", question:="SOE-GOVERNMENT TRANSFERS DISCLOSURE"]
rgi[question=="1.4.10) SOE CORPORATE GOVERNANCE PRACTICE", question:="SOE CORPORATE GOVERNANCE PRACTICE"]
rgi[question=="1.4.7) COMMODITY SALE RULES", question:="COMMODITY SALE RULES"]
rgi[question=="1.4.1) SOE-GOVERNMENT TRANSFERS RULES", question:="SOE-GOVERNMENT TRANSFERS RULES"]
rgi[question=="1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE", question:="SOE-GOVERNMENT TRANSFERS DISCLOSURE"]
rgi[question=="1.4.9) SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE", question:="SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE"]
rgi[question=="1.4.6) SOE PRODUCTION DISCLOSURE", question:="SOE PRODUCTION DISCLOSURE"]
rgi[question=="1.4.5) SOE FINANCIAL REPORTING PRACTICE", question:="SOE FINANCIAL REPORTING PRACTICE"]
rgi[question=="1.4.4) SOE NON-COMMERCIAL ACTIVITY PRACTICE", question:="SOE NON-COMMERCIAL ACTIVITY PRACTICE"]
rgi[question=="1.4.3) SOE FINANCIAL REPORTING RULES", question:="SOE FINANCIAL REPORTING RULES"]
rgi[country %in% mining, unique(country)]
rgi[country %in% oil, unique(country)]
rgi[, iso3:=addISO(country)]
library(googlesheets)
rgi[, iso3:=addISO(country)]
View(rgi)
rgi <- rgi[iso3 %in% c("DZA", "AGO", "SHN", "BEN", "BWA", "BFA", "BDI", "ESH", "CMR", "CPV", "CAF", "TCD", "COM", "COG", "COD", "DJI", "EGY", "GNQ", "ERI", "ETH", "GAB", "GMB", "GHA", "GIN", "GNB", "CIV", "KEN", "LSO", "LBR", "LBY", "MDG", "MWI", "MLI", "MRT", "MUS", "MYT", "MAR", "MOZ", "NAM", "NER", "NGA", "STP", "REU", "RWA", "STP", "SEN", "SYC", "SLE", "SOM", "ZAF", "SSD", "SHN", "SDN", "SWZ", "TZA", "TGO", "TUN", "UGA", "COD", "ZMB", "TZA", "ZWE")]
rgi[country %in% mining, unique(country)]
rgi[country %in% mining, unique(country)]
mining
rgi <- as.data.table(fread("rgi_data.csv", stringsAsFactors = FALSE))
# rgi <- rgi[grep("SOE", question)]
#Sample questions
rgi <- rgi[question %in% c("1.4.8) COMMODITY SALE DISCLOSURES",
"1.4.10) SOE CORPORATE GOVERNANCE PRACTICE",
"1.4.7) COMMODITY SALE RULES",
"1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE",
"1.4.9) SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE",
"1.4.6) SOE PRODUCTION DISCLOSURE",
"1.4.5) SOE FINANCIAL REPORTING PRACTICE",
"1.4.4) SOE NON-COMMERCIAL ACTIVITY PRACTICE",
"1.4.3) SOE FINANCIAL REPORTING RULES",
"1.4.1) SOE-GOVERNMENT TRANSFERS RULES")]
rgi <- rgi[, -c("min","max","range","avg","sd","type_question")]
rgi <- melt(rgi, id.vars="question", variable.name = "country")
rgi <- rgi[value==".", value:=NA]
rgi[, value:=as.numeric(value)]
rgi[, country:=as.character(country)]
rgi[question=="1.4.8) COMMODITY SALE DISCLOSURES", question:="COMMODITY SALE DISCLOSURES"]
rgi[question=="1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE", question:="SOE-GOVERNMENT TRANSFERS DISCLOSURE"]
rgi[question=="1.4.10) SOE CORPORATE GOVERNANCE PRACTICE", question:="SOE CORPORATE GOVERNANCE PRACTICE"]
rgi[question=="1.4.7) COMMODITY SALE RULES", question:="COMMODITY SALE RULES"]
rgi[question=="1.4.1) SOE-GOVERNMENT TRANSFERS RULES", question:="SOE-GOVERNMENT TRANSFERS RULES"]
rgi[question=="1.4.2) SOE-GOVERNMENT TRANSFERS DISCLOSURE", question:="SOE-GOVERNMENT TRANSFERS DISCLOSURE"]
rgi[question=="1.4.9) SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE", question:="SOE JOINT VENTURES AND SUBSIDIARIES DISCLOSURE"]
rgi[question=="1.4.6) SOE PRODUCTION DISCLOSURE", question:="SOE PRODUCTION DISCLOSURE"]
rgi[question=="1.4.5) SOE FINANCIAL REPORTING PRACTICE", question:="SOE FINANCIAL REPORTING PRACTICE"]
rgi[question=="1.4.4) SOE NON-COMMERCIAL ACTIVITY PRACTICE", question:="SOE NON-COMMERCIAL ACTIVITY PRACTICE"]
rgi[question=="1.4.3) SOE FINANCIAL REPORTING RULES", question:="SOE FINANCIAL REPORTING RULES"]
rgi[, iso3:=addISO(country)]
